# Mariodux
[Marionette](https://github.com/marionettejs/backbone.marionette), [Redux](https://github.com/reactjs/redux), and [morphdom](https://github.com/patrick-steele-idem/morphdom)

## Motivation
Migrating an existing project to [React](https://github.com/facebook/react) is not always an option.

This repo is a recreation of [Redux Todos](https://github.com/reactjs/redux/tree/master/examples/todos) demonstrating how Redux and morphdom can be added to an exisitng Marionette project, thus providing the benefit of popular React and Redux features; specifically, unidirectional data flow and DOM diffing.

## Getting Started
Run `bower install`

## How it works
Like React, we'll [render two identical versions of our application's root layout](https://github.com/AndrewHenderson/mariodux/blob/master/index.js#L13-L14).
```js
var root = new Root();
var virtualRoot = new Root();
```
The [true root will be attached to the document](https://github.com/AndrewHenderson/mariodux/blob/master/index.js#L44):
```js
app.rootRegion.show(root);
```
When a [childView dispatches an event](https://github.com/AndrewHenderson/mariodux/blob/master/components/AddTodo.js#L38), a new global state object will be generated by [combineReducers](https://github.com/AndrewHenderson/mariodux/blob/master/reducers/index.js#L9-L12).
```js
dispatch(addTodo(value));
```
When `dispatch` is exectued, the `updateDOM` function will execute, rendering the virutalRoot using latest global state. Morphdom will then diff the newly rendererd virtualDOM with the realDOM and efficiently update the realDOM.
```js
store.subscribe(function updateDOM() {

  var realDOM = root.$el[0];
  var virtualDOM = virtualRoot.render().$el[0];

  morphdom(realDOM, virtualDOM);
});
```
The true root will not be re-rendered. It is only rendered once at the start. From then on, morphdom will do the DOM updating.

Using this approach, each childView will only have to be concerned with rendering once and dispatching events in order to re-render the virtualRoot.
